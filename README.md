# Oral History Prompt Lab
### 优化大语言模型转写老年人口述史的提示词工程实验

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.8+-blue?style=for-the-badge&logo=python" alt="Python version">
  <img src="https://img.shields.io/badge/LLM-DeepSeek-green?style=for-the-badge" alt="LLM Model">
  <img src="https://img.shields.io/badge/Task-Oral%20History%20Rewriting-orange?style=for-the-badge" alt="Task">
  <img src="https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge" alt="License">
</p>

<p align="center">
  <b>探索Few-Shot、CoT与结构化提示策略在口述史转写中的效果差异</b><br>
</p>

---

## 📖 Overview

本项目通过三轮对照实验，系统探索大语言模型（LLM）在转写老年人口述史材料时的提示词（Prompt）优化策略。实验以**DeepSeek-chat**为主要模型，针对口述史转写中的核心挑战——**强加逻辑与事件**、**情感理解失真**、**细节丢失**等问题，逐步迭代优化提示词设计。

### 核心研究问题

1. **如何保留口述原貌？** 避免LLM过度概括、强加因果、美化负面情感
2. **如何增强叙事连贯性？** 在保持时间逻辑的同时不丢失具体细节
3. **如何优化提示词结构？** 对比Few-Shot、Chain-of-Thought (CoT)、结构化指令等策略的效果

### 实验演进路径

| 轮次 | 核心问题 | 策略演进 | 关键发现 |
|--------|-----------|---------|---------|
| **第一轮** | 识别基线问题 | 基础改写 vs. LLM原生输出 | 发现5大类问题：重点提取不当、时间划分不清、背景缺失、用词失真、详略不当 |
| **第二轮** | 对比提示策略 | Base vs. Few-Shot vs. CoT vs. Combined | **Combined Prompt (CoT + Few-Shot)** 效果最佳，显著改善逻辑连贯性 |
| **第三轮** | 优化任务定义 | Basic Combined vs. Improved Structured | **结构化任务定义 + 内化思维过程** 优于过度工程化的分步指令 |

---

## 🧱 Project Structure

```bash
oral-history-prompt-lab/
│
├── README.md
│
├── 第一轮实验文档/
│   └── 第一轮实验过程记录.md
│ 
├── 第二轮实验文档/
│   ├── 第二轮实验过程记录.md
│   ├── 第二轮实验最优提示词.md
│   ├── 第二轮实验案例展示.md
│   ├── 第二轮实验few-shot示例选取.md
│   ├── 第二轮实验处理材料.docx
│   ├── 口述史评级标准.xlsx
│   ├── SecondRound-oral_history_v1.ipynb
│   └── SecondRound-oral_history_v2.ipynb
│
└── 第三轮实验文档/
    ├── 第二轮实验过程记录.md
    ├── 第二轮实验最优提示词.md
    ├── 第二轮实验案例展示.md
    ├── 第三轮实验处理材料.docx
    ├── 口述史评级标准.xlsx
    ├── ThirdRound-oral_history_v1.ipynb
    └── ThirdRound-oral_history_v2.ipynb
```

---

## ✨ Key Contributions

### 1. 系统性问题识别（第一轮）

通过对比原始访谈与LLM输出，我们识别出口述史转写的**5大核心问题**：

| 问题类型 | 具体表现 | 典型案例 |
|---------|---------|---------|
| **重点提取不当** | 将未侧重的细节作为总结重点，罗列缺乏逻辑 | 原文："吃油炸馓子" → LLM输出："没有现代医疗，没有电暖设备"（强加对比） |
| **时间划分不清** | 对具体时间节点理解模糊，时代准确性受损 | 原文隐含"解放后" → LLM未明确标注 |
| **历史背景缺失** | 遗漏关键时代背景，削弱历史价值 | 原文："到了新中国了，免费强制种牛痘" → LLM输出省略政策背景 |
| **用词失真** | 情感转折生硬，插入不自然表达 | 原文生动恐怖故事 → LLM输出："大人教我们：不能拽，要拍打"（说教式结尾） |
| **详略处理不当** | 重点故事过度简略，丢失氛围与细节 | 水鬼传说原文500字 → LLM输出50字概括 |

---

### 2. 提示策略效果对比（第二轮）

我们对比了四种提示策略在**1.5万字口述材料**上的表现：

| 策略 | 核心设计 | NonFact AUC-PR | 关键缺陷 | 最佳适用场景 |
|------|---------|----------------|---------|-------------|
| **Base** | 简单指令："改写成流畅叙述性文字" | 逻辑跳跃严重 | 强加因果，丢失人物关系背景 | 短文本快速改写 |
| **Few-Shot** | 提供2个改写示例 | 过度概括 | 示例长度误导，生成仅600字 | 风格迁移任务 |
| **CoT** | 5步思维链：时间线→人物→逻辑→情感→改写 | 结构机械 | 分步执行导致输出碎片化 | 复杂逻辑梳理 |
| **Combined** | **CoT + Few-Shot + 字数约束** | **87/100分** | 仍有书面化倾向 | **长文本口述史** |

#### 眉心伤疤事件：策略效果微观分析

**原始文本**（口语化、细节丰富）：
> "我爷爷身体不好，没有人出河工怎么办？就我奶奶去...我爷爷就带我过去玩...给了我一个小铲子...我不知道怎么跑到人家后面去了...万幸是万幸，他那个铁锹一打打到我的小铲子那个柄子上了..."

| 策略 | 输出片段 | 问题诊断 |
|------|---------|---------|
| **Base** | "爷爷带我去工地玩，给了我个小铲子...崩到脸上留下了疤" | ❌ 丢失"爷爷身体不好在家带孩子"的因果，直接跳跃到"带去工地" |
| **Few-Shot** | "大人们用铁锹挖土...我拿着小铲子跟在后面玩...崩起的木屑划伤了额头" | ❌ **强加逻辑**："跟在后面玩"（原文是"跑到人家后面"）；**扭曲细节**："木屑"（原文是"铲柄崩到脸上"） |
| **CoT** | "我在一个挖河工的人身后玩...万幸的是没直接打到身上" | ⚠️ 保留因果但丢失"爷爷带我去"的主动性 |
| **Combined** | "爷爷身体不好不能去，就在家带我...挖到我家后面，爷爷带我去玩...我不知道怎么跑到人家后面去了...万幸的是没直接打到身上" | ✅ **完整保留**：身体状况→在家带孩子→工地 proximity→给铲子→乱跑→意外→万幸 |

> **结论**：Combined Prompt通过思维链确保逻辑不跳跃，通过示例引导保持细节丰富度，是当前最佳实践。

---

### 3. 结构化提示词优化（第三轮）

基于认知负荷理论，我们重构了提示词架构，提出**"内化思维过程"**原则：

#### 从 v1（过度工程化）到 v2（原则引导）

**v1 设计**（表现较差）：
```python
# 问题：强制外显思维步骤，打断自然创作流程
IMPROVED_PROMPT_V1 = """
第五步：基于以上详细分析进行改写，确保：
- 保留原文的具体细节
- 字数不少于原文的20%
- 维持原文的个人化表达风格
- 在最终成文时，特别注意：
  - 保持老人朴实自然的语言风格
  - 适当使用口语词汇增强真实感  # 过度具体化！限制创造性
"""
```

**v2 设计**（表现更优，**88/100分**）：
```python
# 优势：原则性指导，给予创作自由度
IMPROVED_PROMPT_V2 = """
步骤一：提取与梳理（信息挖掘）
1. 时间线提取：列出所有明确提及或隐含的时间点
2. 关键事件与故事点：找出人生转折、难忘经历
3. 人物与关系：识别重要人物及其关系
4. 情感与观点：标注强烈情感或核心观点

步骤二：结构与大纲（叙事规划）
基于第一步的梳理，规划口述史的文章结构

步骤三：生成与润色（最终成文）
根据大纲生成最终口述史正文，确保语言连贯、情感真挚
"""
```

#### 关键改进点

| 维度 | v1 (过度约束) | v2 (原则引导) | 理论依据 |
|------|--------------|--------------|---------|
| **思维过程** | 外化为5个强制步骤 | 内化为3个创作阶段 | 减少外部认知负荷 |
| **语言指导** | 列举具体词汇："那时候"、"那会儿" | 原则性要求："保持朴实自然的语言风格" | 避免过度具体化限制创造性 |
| **输出格式** | 强制分节输出（步骤一、二、三） | 允许模型自然整合 | 符合人类传记作家工作流程 |
| **情感处理** | 明确禁止"美化负面情绪" | 强调"情感真挚" | 正向引导优于负面约束 |

**生成质量对比**（以院系历史访谈为例）：

| 评估维度 | Basic Combined (79分) | Improved v2 (88分) | 提升关键 |
|---------|---------------------|-------------------|---------|
| **情感深度** | 10/15（表层叙述） | 11/15（更丰富细腻） | "那会儿才18岁" vs "那时候才18岁" |
| **个人主体性** | 6/10（被宏大叙事淹没） | 8/10（抉择和行动力鲜明） | 强调"个人研究方向转变" |
| **语言风格** | 6/10（过度书面化） | 7/10（保留"满身你不做事情"等口语） | 减少平滑处理 |
| **叙事结构** | 14/15（轻微跳跃） | 15/15（章节标题引导） | 显式大纲规划 |

---

## 📊 Key Results Summary

### 三轮实验核心指标对比

| 实验轮次 | 最佳策略 | 平均得分 | 关键改进 | 主要局限 |
|---------|---------|---------|---------|---------|
| **Round 1** | 基线识别 | - | 建立5大问题分类框架 | 无系统评分 |
| **Round 2** | **Combined Prompt** | **87/100** | CoT+Few-Shot+字数约束 | 仍偏书面化 |
| **Round 3** | **Improved v2 (结构化)** | **88/100** | 内化思维过程，原则性指导 | 情感深度仍有提升空间 |

### 最佳实践提示词模板（可直接使用）

```python
ORAL_HISTORY_PROMPT = """
请你扮演一位富有经验的传记作家和历史学者，专门从事口述史的整理与撰写。

【任务定义】
口述史是基于个人亲历的叙事文体，需要：
1. 时间脉络：以时间顺序为骨架
2. 主题聚焦：突出{theme_focus}
3. 情感与细节：保留受访者独特的语言风格和关键原话
4. 叙事性：语言平实流畅，富有故事性
5. 语言风格：保持老人朴实自然的口语风格

【需避免】
- 禁止虚构：绝不添加未提及的事实
- 禁止罗列：避免"他说...然后他说..."的机械拼接
- 风格不当：避免过度书面化或学术化语言
- 遗漏重点：不得忽略{key_events}

【正面示例】
{positive_example}

【创作步骤】
步骤一：提取与梳理（信息挖掘）
- 时间线：列出所有时间点及对应事件
- 关键事件：找出人生转折、难忘经历
- 人物关系：识别重要人物及其影响
- 情感观点：标注强烈情感表达

步骤二：结构与大纲（叙事规划）
基于梳理结果，规划文章结构

步骤三：生成与润色（最终成文）
生成完整口述史，确保：
- 保留原文所有重要细节，不要过度概括
- 保持老人朴实自然的语言风格
- 字数不少于原文的20%

【待改写内容】
{oral_text}

【输出格式】
【步骤一：信息梳理结果】
【步骤二：文章大纲】
【步骤三：生成的口述史正文】
"""
```

---

## ⚠️ Limitations & Future Work

### 当前局限

1. **模型单一性**：实验主要基于DeepSeek-chat，未充分验证跨模型泛化性（GPT-4、Claude等）
2. **领域局限**：测试数据集中于中国近现代个人史（童年回忆、院系历史），未覆盖其他文化背景或主题类型
3. **评估主观性**：评分依赖DeepSeek自身评判，缺乏人类历史学专家盲评
4. **长度限制**：1.5万字以上长文本的处理策略未充分探索

### 未来方向

- **多模态融合**：结合语音语调信息（停顿、重音）增强情感识别
- **人机协作界面**：开发交互式编辑工具，支持人类史学家实时修正LLM输出
- **跨文化验证**：测试提示词策略在不同语言、文化背景口述史中的效果
- **检索增强生成(RAG)**：接入历史知识库，自动补充时代背景信息

---

## 📄 License

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。
